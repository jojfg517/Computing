# åŠ å¯†è´§å¸ç®—æ³•äº¤æ˜“æ•°æ®å®æˆ˜ï¼šBybit OHLCä¸å®æ—¶ä»·æ ¼è§£æ

## æ•°æ®é©±åŠ¨çš„åŠ å¯†äº¤æ˜“æ ¸å¿ƒé€»è¾‘

åœ¨æ„å»ºåŠ å¯†è´§å¸é‡åŒ–äº¤æ˜“ç³»ç»Ÿæ—¶ï¼Œæ•°æ®è´¨é‡ç›´æ¥å†³å®šäº¤æ˜“ç­–ç•¥çš„å¯é æ€§ã€‚æ— è®ºæ˜¯1åˆ†é’ŸOHLCï¼ˆå¼€ç›˜ã€æœ€é«˜ã€æœ€ä½ã€æ”¶ç›˜ï¼‰è¡Œæƒ…è¿˜æ˜¯å®æ—¶è®¢å•ç°¿å¿«ç…§ï¼Œ**Bybitå¹³å°æä¾›çš„æ ‡å‡†åŒ–APIæ¥å£**ä¸ºå¼€å‘è€…æä¾›äº†è·å–ç»“æ„åŒ–å¸‚åœºæ•°æ®çš„å¯é é€šé“ã€‚æŒæ¡æ•°æ®è·å–ä¸å¤„ç†çš„æ ¸å¿ƒæŠ€èƒ½ï¼Œæ˜¯æ„å»ºç¨³å¥äº¤æ˜“ç³»ç»Ÿçš„å…³é”®èµ·ç‚¹ã€‚

ğŸ‘‰ [æé€Ÿæ¥å…¥å…¨çƒé¡¶çº§åŠ å¯†äº¤æ˜“å¹³å°](https://bit.ly/okx_welcome)

### æ ¸å¿ƒå†…å®¹æ¦‚è§ˆ
- å®æ—¶åˆçº¦è¡Œæƒ…è·å–ï¼šåŠ¨æ€ç›‘æ§500+äº¤æ˜“å¯¹
- OHLCæ•°æ®è§£æï¼šä»APIå“åº”åˆ°ç»“æ„åŒ–å­˜å‚¨
- é‡‘èå›¾è¡¨å¯è§†åŒ–ï¼šmplfinanceä¸“ä¸šçº§ç»˜å›¾
- å¤šå‘¨æœŸæ•°æ®è½¬æ¢ï¼š1åˆ†é’Ÿè‡³æ—¥Kçº¿çš„æ™ºèƒ½èšåˆ
- ç­–ç•¥ç ”ç©¶åŠ é€Ÿï¼šé«˜æ•ˆæ•°æ®å­˜å‚¨ä¸å›æµ‹å‡†å¤‡

---

## è·å–å®æ—¶åˆçº¦è¡Œæƒ…æ•°æ®

### å¸‚åœºåŠ¨æ€ç›‘æ§åŸºç¡€
é€šè¿‡Bybitçš„`get_tickers`æ¥å£ï¼Œå¼€å‘è€…å¯å®æ—¶è·å–çº¿æ€§åˆçº¦å¸‚åœºçš„å®Œæ•´äº¤æ˜“å¯¹æ¸…å•ã€‚è¯¥æ¥å£è¿”å›çš„563ä¸ªæ´»è·ƒäº¤æ˜“å¯¹æ•°æ®åŒ…å«å…³é”®æŒ‡æ ‡ï¼š
- æœ€æ–°ä»·æ ¼ï¼ˆlastPriceï¼‰
- èµ„é‡‘è´¹ç‡ï¼ˆfundingRateï¼‰
- æŒä»“é‡ï¼ˆopenInterestï¼‰
- æœ€ä½³ä¹°å–ç›˜å£ï¼ˆbid1Price/ask1Priceï¼‰

```python
from helpers.get_bybit_http import get_client
# æµ‹è¯•ç¯å¢ƒåˆå§‹åŒ–
client = get_client(testnet=True)

# è·å–USDTçº¿æ€§åˆçº¦è¡Œæƒ…
result = client.get_tickers(category='linear')
tickers = result.get('result', {}).get('list', [])
```

### ç»“æ„åŒ–æ•°æ®å¤„ç†å®è·µ
å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºPandas DataFrameåï¼Œå¯ä¾¿æ·è¿›è¡Œå¤šç»´åˆ†æï¼š

| å­—æ®µåç§°            | æ•°æ®å«ä¹‰               | å…¸å‹åº”ç”¨åœºæ™¯               |
|---------------------|------------------------|--------------------------|
| price24hPcnt        | 24å°æ—¶ä»·æ ¼å˜åŠ¨ç™¾åˆ†æ¯”   | æ³¢åŠ¨ç‡ç›‘æ§               |
| turnover24h         | 24å°æ—¶æˆäº¤é¢ï¼ˆUSDTï¼‰   | æµåŠ¨æ€§ç­›é€‰               |
| nextFundingTime     | ä¸‹æ¬¡èµ„é‡‘ç»“ç®—æ—¶é—´æˆ³     | å¥—åˆ©ç­–ç•¥æ—¶é—´çª—å£         |

```python
import pandas as pd
ticker_df = pd.DataFrame(tickers)
# ç­›é€‰é«˜æµåŠ¨æ€§äº¤æ˜“å¯¹
high_liquidity = ticker_df[ticker_df['turnover24h'].astype(float) > 1e6]
```

---

## å†å²OHLCæ•°æ®è·å–ä¸å¤„ç†

### APIè°ƒç”¨å‚æ•°è¯¦è§£
é€šè¿‡`get_kline`æ¥å£è·å–Kçº¿æ•°æ®æ—¶ï¼Œéœ€ç‰¹åˆ«æ³¨æ„å‚æ•°ç»„åˆï¼š

| å‚æ•°        | å¿…å¡« | ç±»å‹      | ç‰¹æ®Šè¯´æ˜                     |
|-------------|------|-----------|------------------------------|
| interval    | âœ…   | å­—ç¬¦ä¸²    | æ”¯æŒ1,5,15,30,60åˆ†é’ŸåŠD/W/M   |
| start       | âŒ   | æ—¶é—´æˆ³(ms)| ç²¾ç¡®åˆ°æ¯«ç§’çš„æ—¶é—´èŒƒå›´æ§åˆ¶     |

```python
# è·å–ETHUSDTæ—¥Kçº¿ç¤ºä¾‹
response = client.get_kline(
    category='linear',
    symbol='ETHUSDT',
    interval='D'
).get('result', {}).get('list', [])
```

### å¤§è§„æ¨¡æ•°æ®é‡‡é›†ä¼˜åŒ–
é’ˆå¯¹å†å²æ•°æ®å›æº¯éœ€æ±‚ï¼Œé‡‡ç”¨åˆ†é¡µæ‹‰å–ç­–ç•¥å¯çªç ´å•æ¬¡200æ¡é™åˆ¶ï¼š

```python
def fetch_historical_data(symbol, interval, start_date):
    start = int(start_date.timestamp() * 1000)
    df = pd.DataFrame()
    while True:
        response = client.get_kline(
            category='linear',
            symbol=symbol,
            interval=interval,
            start=start,
            limit=1000
        )
        new_data = format_data(response.get('result', {}).get('list', []))
        df = pd.concat([df, new_data])
        start = get_last_timestamp(new_data)
        if len(new_data) < 2: break
    return df.drop_duplicates()
```

ğŸ‘‰ [ä½“éªŒä¸“ä¸šçº§é‡åŒ–äº¤æ˜“å·¥å…·](https://bit.ly/okx_welcome)

---

## é‡‘èå›¾è¡¨å¯è§†åŒ–å®æˆ˜

### mplfinanceä¸“ä¸šå›¾è¡¨ç»˜åˆ¶
é‡‡ç”¨`mplfinance`åº“å¯ç”ŸæˆTradingViewçº§åˆ«çš„ä¸“ä¸šå›¾è¡¨ï¼š

```python
import mplfinance as mpf
# æ„å»º7æ—¥Kçº¿æ•°æ®é›†
days_look_back = 7 * 24 * 4  # 15åˆ†é’Ÿç²’åº¦
ohlc_df = df[['open', 'high', 'low', 'close', 'volume']][-days_look_back:]
# ç”ŸæˆåŒå›¾è¡¨å¸ƒå±€
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 6))
mpf.plot(ohlc_df, type='candle', ax=ax1, style='yahoo')
mpf.plot(ohlc_df, type='line', ax=ax2, style='charles')
```

### å¤šå‘¨æœŸè”åŠ¨åˆ†æ
é€šè¿‡æ•°æ®é‡é‡‡æ ·æŠ€æœ¯ï¼Œå®ç°åˆ†é’Ÿçº§åˆ°æ—¥Kçº¿çš„æ™ºèƒ½è½¬æ¢ï¼š

```python
def resample_ohlc(df, interval):
    return df.resample(interval).agg({
        'open': 'first',
        'high': 'max',
        'low': 'min',
        'close': 'last',
        'volume': 'sum'
    })

# è½¬æ¢ä¸ºå°æ—¶çº§æ•°æ®
hourly_data = resample_ohlc(df, 'h')
```

---

## é«˜çº§æ•°æ®ç®¡ç†æŠ€å·§

### æ•°æ®æŒä¹…åŒ–å­˜å‚¨
é‡‡ç”¨CSVæ ¼å¼å­˜å‚¨å¯ç¡®ä¿æ•°æ®å¤ç”¨æ•ˆç‡ï¼š

```python
# ä¿å­˜è‡³CSV
df.to_csv('data/BTCUSDT_15min.csv', index=False)
# å¿«é€ŸåŠ è½½
df = pd.read_csv('data/BTCUSDT_15min.csv')
df.index = pd.to_datetime(df.timestamp, unit='ms', utc=True)
```

### å›æµ‹æ•°æ®å‡†å¤‡
æ„å»ºæ ‡å‡†åŒ–æ•°æ®ä»“åº“éœ€æ³¨æ„ï¼š
1. æ—¶é—´æˆ³ç»Ÿä¸€ä¸ºUTCæ—¶é—´
2. ä»·æ ¼å­—æ®µå¼ºåˆ¶è½¬æ¢ä¸ºæµ®ç‚¹æ•°
3. äº¤æ˜“é‡å­—æ®µé‡‡ç”¨ç´¯è®¡è®¡æ•°

---

## å¸¸è§é—®é¢˜è§£ç­”

### Qï¼šAPIè°ƒç”¨é¢‘ç‡é™åˆ¶å¦‚ä½•åº”å¯¹ï¼Ÿ
Bybitå¯¹å…¬å¼€APIè®¾ç½®æ¯åˆ†é’Ÿ60æ¬¡è¯·æ±‚é™åˆ¶ã€‚å»ºè®®é‡‡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š
1. ä½¿ç”¨`time.sleep(0.01)`æ§åˆ¶è¯·æ±‚é—´éš”
2. æ‰¹é‡è·å–å¤šäº¤æ˜“å¯¹æ•°æ®
3. ä¼˜å…ˆä½¿ç”¨ç»„åˆå‚æ•°ï¼ˆå¦‚category='linear'ï¼‰

### Qï¼šå¦‚ä½•å¤„ç†æ—¶é—´æˆ³è½¬æ¢é—®é¢˜ï¼Ÿ
Bybitè¿”å›çš„æ—¶é—´æˆ³ä¸ºæ¯«ç§’çº§UTCæ—¶é—´ï¼Œè½¬æ¢æ—¶éœ€æ³¨æ„ï¼š
```python
pd.to_datetime(data['timestamp'].astype(int), unit='ms', utc=True)
```

### Qï¼šå¦‚ä½•ç¡®ä¿æ•°æ®å®Œæ•´æ€§ï¼Ÿ
é‡‡ç”¨å¢é‡æ›´æ–°æœºåˆ¶å¯æœ‰æ•ˆé¿å…æ•°æ®ä¸¢å¤±ï¼š
```python
existing_df = pd.read_csv('data.csv')
new_df = fetch_new_data()
merged_df = pd.concat([existing_df, new_df]).drop_duplicates()
```

ğŸ‘‰ [è·å–å®Œæ•´äº¤æ˜“æ•°æ®è§£å†³æ–¹æ¡ˆ](https://bit.ly/okx_welcome)

---

## æ•°æ®é©±åŠ¨çš„äº¤æ˜“ç³»ç»Ÿæ„å»ºè·¯å¾„

é€šè¿‡ç³»ç»ŸåŒ–æŒæ¡Bybit APIæ•°æ®æ¥å£çš„è°ƒç”¨æ–¹æ³•ï¼Œå¼€å‘è€…å¯é€æ­¥æ„å»ºåŒ…å«ä»¥ä¸‹æ¨¡å—çš„äº¤æ˜“ç³»ç»Ÿï¼š
1. **æ•°æ®å±‚**ï¼šå¤šå‘¨æœŸè¡Œæƒ…é‡‡é›†ä¸å­˜å‚¨
2. **ç­–ç•¥å±‚**ï¼šåŸºäºæŠ€æœ¯æŒ‡æ ‡çš„è‡ªåŠ¨åŒ–äº¤æ˜“
3. **æ‰§è¡Œå±‚**ï¼šä½å»¶è¿Ÿè®¢å•ç®¡ç†ç³»ç»Ÿ
4. **é£æ§å±‚**ï¼šå®æ—¶å¤´å¯¸ä¸é£é™©ç›‘æ§

å®Œæ•´çš„Pythonå·¥å…·åŒ…å·²é€šè¿‡GitHubå¼€æºï¼ŒåŒ…å«APIå°è£…ã€æ•°æ®å¤„ç†ã€ç­–ç•¥æ¨¡æ¿ç­‰æ ¸å¿ƒæ¨¡å—ã€‚[è®¿é—®å·¥å…·åŒ…](https://github.com/codearmo/BybitPythonTools)ï¼ˆæ³¨ï¼šæ ¹æ®æ”¿ç­–è¦æ±‚ï¼Œå¤–éƒ¨é“¾æ¥å·²åšåˆè§„å¤„ç†ï¼‰

æŒç»­å…³æ³¨åŠ å¯†å¸‚åœºæ•°æ®ç‰¹æ€§ï¼Œç»“åˆé‡åŒ–åˆ†ææ–¹æ³•ï¼Œå°†å¸®åŠ©äº¤æ˜“è€…åœ¨æ³¢åŠ¨å¸‚åœºä¸­å‘ç°æ›´å¤šæ½œåœ¨æœºä¼šã€‚